<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>TIL: Indexing `NULL` in Oracle Database</title>
  <meta name="description" content="Oracle database does not index a row if all the indexed columns are NULL">

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://kw7oe.github.io/til/database%20index/2019/02/18/til-indexing-null-in-oracle-database.html">
  <link rel="alternate" type="application/rss+xml" title="kw7oe" href="/feed.xml">

  
</head>


  <body>

    

    <div class="section">
  <main class="main-col" aria-label="Content">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">TIL: Indexing `NULL` in Oracle Database</h1>
    <small class="post-meta">
      <time datetime="2019-02-18T21:32:00+08:00" itemprop="datePublished">
        
        Feb 18, 2019
      </time>
      </small>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Oracle database does not index a row if all the indexed columns are <code class="highlighter-rouge">NULL</code></p>

<p>For instance, let say we have a <code class="highlighter-rouge">users</code> table where we index <code class="highlighter-rouge">role</code> column to improve the query performance.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="n">users</span> <span class="k">WHERE</span> <span class="k">role</span> <span class="k">IS</span> <span class="k">NULL</span>
</code></pre></div></div>

<p>The index does not work for such query in Oracle database. This is because when Oracle database is inserting the new record of <code class="highlighter-rouge">user</code> where the <code class="highlighter-rouge">role</code> is <code class="highlighter-rouge">NULL</code>, it does not add the created row to the index. Hence, the index is not useful when querying with <code class="highlighter-rouge">NULL</code></p>

<h3 id="solutions">Solutions</h3>

<p>Use a constant expression that can never be <code class="highlighter-rouge">NULL</code>.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">users_role</span> <span class="k">ON</span> <span class="n">users</span> <span class="p">(</span><span class="k">role</span><span class="p">,</span> <span class="s1">'user'</span><span class="p">)</span>
</code></pre></div></div>

<p>or we can use a concatenated index (multi-column index) and ensure that the the other column of the index must have a <code class="highlighter-rouge">NOT NULL</code> constraint.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">users_role</span> <span class="k">ON</span> <span class="n">users</span> <span class="p">(</span><span class="k">role</span><span class="p">,</span> <span class="n">id</span><span class="p">)</span>
</code></pre></div></div>

<p>For more detailed explanation and source, refer to <a href="https://use-the-index-luke.com/sql/where-clause/null">NULL in Oracle Database</a></p>

<hr />
<p><small>This post was first appeared in my TIL web application at <a href="https://til.kaiwern.com/posts/4">here</a>.</small></p>


  </div>

  
    

  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = 'https://kw7oe.github.io/til/database%20index/2019/02/18/til-indexing-null-in-oracle-database.html';
      this.page.identifier = 'https://kw7oe.github.io/til/database%20index/2019/02/18/til-indexing-null-in-oracle-database.html';
    };

    (function() {
      var d = document, s = d.createElement('script');

      s.src = 'https://kw7oe-github-io.disqus.com/embed.js';

      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


  
</article>

  </main>
</div>

    
    <script src="/assets/custom.js"></script>
  </body>

</html>
